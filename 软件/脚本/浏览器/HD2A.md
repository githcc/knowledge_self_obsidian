// ==UserScript==
// @namespace greasyfork
// @name HD2A
// @version 0.2.3
// @downloadURL http://121.5.226.51/tampermonkey/hd2a.user.js
// @match https://nyaa.si/*
// @match https://pan.baidu.com/*
// @match https://search.bilibili.com/*
// @match https://space.bilibili.com/*
// @match https://sukebei.nyaa.si/*
// @match https://v.qq.com/*
// @match https://wallhaven.cc/*
// @match https://www.bilibili.com/*
// @connect greasyfork.org
// @connect baidu.com
// @connect localhost
// @connect 127.0.0.1
// @connect *
// @noframes
// @grant GM_info
// @grant GM_cookie
// @grant GM_addStyle
// @grant GM_download
// @grant GM_getValue
// @grant GM_setValue
// @grant GM_openInTab
// @grant GM_setClipboard
// @grant GM_xmlhttpRequest
// @grant unsafeWindow
// @grant window.onurlchange
// @run-at document-body
// ==/UserScript==
function zset(){u.zdom();let s,dom=document.createElement("form");switch(u.zhost()){case"bilibili_com":s='<div> <div>\u5e38\u89c4\u8bbe\u7f6e</div> <label><input name="vhd" type="checkbox" value="1"> \u542f\u7528\u9ad8\u753b\u8d28\u64ad\u653e\u89c6\u9891</label> <label><input name="follow" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u5173\u6ce8UP</label> <label><input name="coin" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u6295\u5e01</label> <label><input name="collect" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u6536\u85cf</label> <label><input name="discuss" type="checkbox" value="1"> \u6388\u6743\u811a\u672c\u53ef\u8bc4\u8bba</label> </div> <label>\u5f53\u524d\u8d26\u53f7\u5bf9\u5e94\u7684\u624b\u673a\u53f7\u7801 <input name="phone" type="text" placeholder="\u7528\u4e8e\u81ea\u52a8\u5e94\u7b54B\u7ad9\u7684\u9a8c\u8bc1"></label> <label>\u52a0\u901f\u8282\u70b9 <select name="cdn"> <option value="shut">\u5173\u95ed</option> <option value="akamaiupos-hz-mirrorakam.akamaized.net">\u963f\u5361\u8fc8 akamai</option> <option value="upos-sz-mirrorali.bilivideo.com">\u963f\u91cc 1</option> <option value="upos-sz-mirroralib.bilivideo.com">\u963f\u91cc 2</option> <option value="upos-sz-mirrorcos.bilivideo.com">\u817e\u8baf 1</option> <option value="upos-sz-mirrorcosb.bilivideo.com">\u817e\u8baf 2</option> <option value="upos-sz-mirrorhw.bilivideo.com">\u534e\u4e3a 1</option> <option value="upos-sz-mirrorhwb.bilivideo.com">\u534e\u4e3a 2</option> <option value="upos-sz-mirrorkodo.bilivideo.com">\u4e03\u725b 1</option> <option value="upos-sz-mirrorkodob.bilivideo.com">\u4e03\u725b 2</option> <option value="upos-sz-mirrorks3.bilivideo.com">\u91d1\u5c71 ks3</option> <option value="upos-sz-mirrorks32.bilivideo.com">\u91d1\u5c71 ks32</option> <option value="upos-sz-mirrorks3b.bilivideo.com">\u91d1\u5c71 ks3b</option> <option value="upos-sz-mirrorks3c.bilivideo.com">\u91d1\u5c71 ks3c</option> <option value="upos-sz-mirrorbos.bilivideo.com">\u767e\u5ea6</option> <option value="upos-sz-upcdnbda2.bilivideo.com">upcdnbda2</option> <option value="upos-sz-upcdnhw.bilivideo.com">upcdnhw</option> <option value="upos-sz-upcdntx.bilivideo.com">upcdntx</option> <option value="upos-sz-upcdnws.bilivideo.com">upcdnws</option> </select></label> <label>\u8bbe\u7f6ejsonrpc <input name="jsonrpc" type="text" placeholder="http://localhost:16800/jsonrpc" required></label> <label>\u8bbe\u7f6e\u8bbf\u95ee\u53e3\u4ee4 <input name="token" placeholder="\u6ca1\u6709\u53e3\u4ee4\u5219\u4e0d\u8981\u586b\u5199" type="text"></label> <div class="btn-group"> <button type="button"> <i class="bi-x-square"></i> \u53d6\u6d88 </button> <button type="submit"> <i class="bi-check2-square"></i> \u786e\u5b9a </button> </div>';break;case"youtube_com":s='<label>\u8bbe\u7f6ejsonrpc <input name="jsonrpc" type="text" placeholder="http://localhost:16800/jsonrpc" required></label><label>\u8bbe\u7f6e\u8bbf\u95ee\u53e3\u4ee4 <input name="token" type="text" placeholder="\u6ca1\u6709\u53e3\u4ee4\u5219\u4e0d\u8981\u586b\u5199"></label><label>\u8bbe\u7f6e\u4ee3\u7406\u670d\u52a1\u5668 <input name="proxy" type="text" placeholder="\u52a1\u5fc5\u8bbe\u7f6e\u6b63\u786e\u7684\u4ee3\u7406"></label><div class="summary">\u6839\u636e\u81ea\u5df1\u6240\u7528\u7684\u68af\u5b50\u8bbe\u7f6e\u6b63\u786e\u7684\u4ee3\u7406\u624d\u80fd\u4e0b\u8f7d</div> <div class="btn-group"><button type="button"><i class="bi-x-square"></i> \u53d6\u6d88 </button><button type="submit"><i class="bi-check2-square"></i> \u786e\u5b9a </button></div>';break;default:s='<label>\u8bbe\u7f6ejsonrpc <input name="jsonrpc" type="text" placeholder="http://localhost:16800/jsonrpc" required></label><label>\u8bbe\u7f6e\u8bbf\u95ee\u53e3\u4ee4 <input name="token"  type="text" placeholder="\u6ca1\u6709\u53e3\u4ee4\u5219\u4e0d\u8981\u586b\u5199"></label><div class="btn-group"><button type="button"><i class="bi-x-square"></i> \u53d6\u6d88</button><button type="submit"><i class="bi-check2-square"></i> \u786e\u5b9a</button></div>'}dom.method="dialog",dom.addEventListener("submit",e=>{e.preventDefault(),e.stopPropagation();let d=new FormData(e.target);if(pod.aria2=Object.assign({},pod.defaults,Object.fromEntries(d.entries())),d.has("jsonrpc")&&GM_setValue("jsonrpc",pod.aria2.jsonrpc),Object.entries(pod.aria2).forEach(t=>{/^\d+$/.test(t[1])&&("phone"==t[0]?11!=t[1].length&&(por.aria2[t[0]]=""):pod.aria2[t[0]]=Number.parseInt(t[1]))}),u.save("aria2",pod.aria2),document.querySelector("#liveDialog").close(),"bilibili_com"==u.zhost()){let body=new FormData;body.append("follow",d.has("follow")?d.get("follow"):0),body.append("coin",d.has("coin")?d.get("coin"):0),body.append("collect",d.has("collect")?d.get("collect"):0),body.append("discuss",d.has("discuss")?d.get("discuss"):0),fetch(`${pod.home}/api/bzcoin?${new URLSearchParams(body).toString()}&usign=${pod.usign}`,{method:"GET",mode:"cors",credentials:"same-origin"}).then(r=>r.json()).then(d=>{})}}),dom.insertAdjacentHTML("beforeend",s),dom.querySelector("button[type=button]").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),document.querySelector("#liveDialog").close()}),u.dialog(dom),setTimeout(()=>{pod.aria2&&(location.hostname.includes("bilibili.com")?fetch(pod.home+"/api/bzusta?usign="+pod.usign).then(r=>r.json()).then(d=>{0==d.code&&(pod.aria2.follow=d.data.follow,pod.aria2.coin=d.data.coin,pod.aria2.collect=d.data.collect,pod.aria2.discuss=d.data.discuss,u.save("aria2",pod.aria2)),u.zform("#liveDialog [name]",pod.aria2)}):u.zform("#liveDialog [name]",pod.aria2))},100)}const u={now:()=>Math.floor(Date.now()/1e3),uid:()=>Date.now().toString(36).toUpperCase(),zhost:()=>location.hostname.split(".").slice(-2).join("_"),cclean:arr=>Object.entries(Object.fromEntries(arr.map(t=>[t.name,t.value]))).map(t=>t.join("=")),fixurl:str=>str.startsWith("http")?str:str.startsWith("//")?location.protocol+str:str.startsWith("/")?location.origin+str:location.origin+"/"+str,rand:max=>Math.floor(1e3*Math.random())%max,serialize:obj=>"object"==typeof obj?new URLSearchParams(Object.entries(obj)).toString():obj,usp:str=>Object.fromEntries(new URLSearchParams(str).entries()),vobj:obj=>"[object Object]"==Object.prototype.toString.call(obj),wait:ms=>new Promise(resolve=>setTimeout(resolve,ms)),ajax:obj=>new Promise(resolve=>{GM_xmlhttpRequest({url:obj.url,method:obj?.method??"GET",responseType:obj?.responseType??"json",onload:function(r){resolve("text"==obj.responseType?r:r.response)}})}),xpath:str=>document.evaluate(str,document).iterateNext(),passwd(bit=4){let i,arr=[];for(i=0;bit>i;i++)arr.push("abcdefghijklmnopqrstuvwxyz23456789ABCDEFGHKLMNPSTVWXY"[u.rand(53)]);return arr.join("")},zdom(top=0){let e=window.event;return null==e?null:(e.preventDefault(),e.stopPropagation(),0==top?e.currentTarget:e.target)},zero(num,bit=2){let i=Number.parseInt(num),s=Number.isSafeInteger(i)?i.toString():"0";return s.padStart(bit,"0")},zinput(dom,str){dom.value=str,dom.hasOwnProperty("_valueTracker")&&dom._valueTracker.setValue(""),dom.dispatchEvent(new Event("input",{bubbles:true}))},aria2(list){let arr=[],imax=list[0].url[0].includes("baidupcs.com")?"1":"5",box={id:u.uid(),method:"system.multicall",params:[]};arr.push({methodName:"aria2.changeGlobalOption",params:[{"allow-overwrite":"false","auto-file-renaming":"false","file-allocation":"falloc","uri-selector":"inorder","max-concurrent-downloads":imax}]}),list.forEach(t=>{Object.keys(t).forEach(p=>{"number"==typeof t[p]&&(t[p]=t[p].toString())});let o={methodName:"aria2.addUri",params:[]};pod?.aria2?.token&&o.params.push("token:"+pod.aria2.token),o.params.push(t.url),o.params.push(t),arr.push(o)}),box.params.push(arr),GM_xmlhttpRequest({url:pod.aria2.jsonrpc,method:"POST",responseType:"json",data:JSON.stringify(box),onerror(){u.dialog("1.\u68c0\u67e5aria2\u6216\u8005motrix\u662f\u5426\u5df2\u7ecf\u8fd0\u884c<br>2.\u68c0\u67e5\u811a\u672c\u8bbe\u7f6e\u7684jsonrpc\u662f\u5426\u6b63\u786e<br>\u9ed8\u8ba4\u7aef\u53e3\u53f7 aria2=6800 motrix=16800")}})},zform(str,obj){let arr=document.querySelectorAll(str);arr.length&&arr.forEach(t=>{let s=t.getAttribute("name");if(obj.hasOwnProperty(s)){let v=obj[s];switch(t.getAttribute("type")){case"radio":t.checked=v==t.value;break;case"checkbox":t.checked=!!v;break;default:t.value=v}}})},domcopy(element){let dom=null;return element instanceof HTMLElement&&(dom=element.cloneNode(true),element.after(dom),element.remove()),dom},domremove(list){list.forEach(t=>{let dom=t.startsWith("/html/")?u.xpath(t):document.querySelector(t);null!=dom&&dom.remove()})},domhide(list){list.forEach(t=>{let dom=t.startsWith("/html/")?u.xpath(t):document.querySelector(t);null!=dom&&(dom.style.cssText="display: none !important")})},cookie(k,v){if(null==v)document.cookie=k+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT";else{let i=new Date;i.setTime(9e9+i.getTime()),document.cookie=`${k}=${v}; expires=${i.toUTCString()}; path=/`}},load(k,v){return v=v??null,GM_getValue(k+"_"+u.zhost(),v)},save(k,v){v=v??null,GM_setValue(k+"_"+u.zhost(),v)},strcut(str,a,b){let x,y,s=str;return str.includes(a)&&(x=str.indexOf(a)+a.length,null!=b&&-1!=(y=str.indexOf(b,x))||(y=str.length),s=str.slice(x,y)),s},str2obj(str){return"string"==typeof str&&str.length?str.includes('"')?JSON.parse(str):JSON.parse(str.replaceAll(/'/g,'"')):null},download(str){let o=str.startsWith("magnet:")?{url:[]}:{url:[],"use-header":"true","min-split-size":"1M",split:"8"};Object.assign(o,pod.aria2),str=str.startsWith("magnet:")||str.startsWith("http")?str:str.startsWith("//")?`${location.protocol}${str}`:str.startsWith("/")?`${location.origin}${str}`:`${location.origin}/${str}`,o.url.push(str),u.aria2([o])},namefix(str){let i,arr=['"',"'","*",":","<",">","?","|"];for(i=0;arr.length>i;i++)str=str.replaceAll(arr[i],"");return(str=str.replaceAll(/\s+/g,"-").replaceAll("_","-").replaceAll("\\","/").replaceAll("//","/")).startsWith("/")?str.slice(1):str},tpl(str,data){return(Array.isArray(data)?data:[data]).map(t=>{return obj=t,str.replaceAll(/\[(\w{1,16})\]/g,(matched,major)=>obj.hasOwnProperty(major)?obj[major]:major);var obj}).join("")},history(str){const origin=history[str];return function(){let e=new Event(str);return e.arguments=arguments,window.dispatchEvent(e),origin.apply(this,arguments)}},jsload(url,name){let dom=document.createElement("script");dom.src=u.fixurl(url),null!=name&&dom.setAttribute("name",name),dom.setAttribute("charset","utf-8"),dom.setAttribute("crossorigin","anonymous"),document.head.appendChild(dom)},swClassName(str){if("string"==typeof str&&str.length){let arr=Array.from(pod.checkbox.classList);arr.includes(str)?arr=arr.filter(t=>t!=str):arr.push("on"),pod.checkbox.className=arr.join(" ")}},dialog(obj){if(null!=obj){let dom=document.querySelector("#liveDialog");null==dom&&(dom=document.createElement("dialog"),document.body.appendChild(dom),dom.id="liveDialog",dom.addEventListener("click",e=>{e.target==e.currentTarget&&(e.preventDefault(),e.stopPropagation(),e.target.close())})),obj instanceof HTMLElement?(dom.innerHTML="",dom.appendChild(obj)):dom.innerHTML=`<div style="max-width:30rem;line-height:1.6">${obj.toString()}</div>`,dom.showModal(),setTimeout(()=>{let dom=document.activeElement;"BODY"!=dom.tagName&&dom.blur()},200)}}};let pod={version:GM_info.script.version,home:"https://121.5.226.51",jsonrpc:"http://localhost:16800/jsonrpc",cookie:"",wait:0,now:u.now()};if(GM_addStyle('@import"https://cdn.bootcdn.net/ajax/libs/bootstrap-icons/1.10.4/font/bootstrap-icons.min.css";body{max-width:100vw;overflow-x:hidden}#zym{background-color:rgba(255,255,255,.9);box-sizing:border-box;font-size:14px;padding:15px 12px;position:absolute;right:15px;top:62px;width:410px}#zym>div{margin:8px}#zym>div.btn-group{font-size:12.5px;margin:0}#zym>div[name=path]>span{cursor:default}#zym>div[name=path]>span:not(:first-child):before{color:#666;content:"\uf231";font-family:"bootstrap-icons";font-size:12px;padding:0 8px;vertical-align:-0.15em}#zym>div[name=full]{overflow-y:auto;scrollbar-width:none}#zym>div[name=full]::-webkit-scrollbar{display:none}#zym>div>table{width:100%}#zym>div>table>tbody>tr{border-top:1px solid #bdf}#zym>div>table>tbody>tr:last-child{border-bottom:1px solid #bdf}#zym>div>table>tbody>tr.on{background-color:#cbedff;color:#000}#zym>div>table>tbody>tr.on>td:nth-child(1){color:#09f}#zym>div>table>tbody>tr.on>td:nth-child(1):before{content:"\uf517"}#zym>div>table>tbody>tr>td{cursor:default;line-height:40px}#zym>div>table>tbody>tr>td:nth-child(1){color:#000;padding:0 .5rem}#zym>div>table>tbody>tr>td:nth-child(1):before{content:"\uf28a";font-family:"bootstrap-icons";font-size:12px;vertical-align:-0.15em}#zym>div>table>tbody>tr>td:nth-child(2){max-width:274px;overflow:hidden;text-overflow:"";white-space:nowrap;word-wrap:normal}#zym>div>table>tbody>tr>td:nth-child(2)>input{background-color:rgba(0,0,0,0);border:none;outline:none;width:100%}#zym>div>table>tbody>tr>td:nth-child(3){padding:0 .5rem;text-align:right}#liveDialog{border:none;cursor:default;font-family:"Microsoft YaHei UI",monospace;font-size:14px !important;margin:auto;max-width:720px;padding:1rem;text-align:justify}#liveDialog a{text-decoration:none}#liveDialog ul{list-style:none inside none;margin:0;overflow-y:auto;padding:0;scrollbar-width:none}#liveDialog ul::-webkit-scrollbar{display:none}#liveDialog ul.ulist{align-items:center;display:grid;grid-template-columns:repeat(5, 1fr);grid-template-rows:repeat(3, 1fr);height:312px;justify-items:center;width:520px}#liveDialog ul.ulist>li{margin:0;padding:0}#liveDialog ul.ulist>li>img{border:none;border-radius:20%;display:block}#liveDialog ul.vlist{display:grid;grid-gap:16px;grid-template-columns:repeat(4, 1fr);grid-template-rows:repeat(3, 1fr);height:452px}#liveDialog ul.vlist>li{height:140px;margin:0;padding:0;width:160px}#liveDialog ul.vlist>li>a{color:#333;cursor:default;display:block}#liveDialog ul.vlist>li>a>img{display:block}#liveDialog ul.vlist>li>a>div.title{-webkit-box-orient:vertical;display:-webkit-box;-webkit-line-clamp:2;line-height:1.25;margin:0 0 5px 2px;overflow:hidden;white-space:normal}#liveDialog form{display:block;margin:0;min-width:320px;padding:0}#liveDialog form input{box-shadow:none;color:#000}#liveDialog form input:focus{box-shadow:none;outline:none}#liveDialog form input[type=text]{background-color:#fff;border:1px solid #999;box-sizing:border-box;display:block;font-size:inherit;padding:.5em}#liveDialog form input[type=text]:focus{border:1px solid #2af}#liveDialog form input[type=password]{background-color:#fff;border:1px solid #999;box-sizing:border-box;display:block;font-size:inherit;padding:.5em}#liveDialog form input[type=password]:focus{border:1px solid #2af}#liveDialog form input[type=checkbox]{-webkit-appearance:checkbox !important}#liveDialog form input[type=radio]{-webkit-appearance:radio !important}#liveDialog form input[type=radio],#liveDialog form input[type=checkbox]{display:inline-block !important;height:1em;margin-right:.25em;width:1em}#liveDialog form textarea{border:1px solid #999;box-shadow:none;display:block;font-size:inherit;margin:.5rem 0;outline:none;padding:.5em;resize:none;width:calc(100% - 1em)}#liveDialog form textarea:focus{border:1px solid #2af}#liveDialog form label{display:block;margin:.5rem 0}#liveDialog form label>input{display:block;margin-top:.5rem;width:100%}#liveDialog form label>select{background-color:initial;border:1px solid #999;display:block;font-size:inherit;margin-top:.5rem;padding:.5em;width:100%}#liveDialog form>div{padding:8px 0}#liveDialog form>div.input-group{display:flex}#liveDialog form>div.input-group>input{flex:auto}#liveDialog form>div.input-group>button,#liveDialog form>div.input-group lable,#liveDialog form>div.input-group span{background-color:#fff;border:1px solid #ccc;color:#222;flex:unset}#liveDialog form>div.input-group>button,#liveDialog form>div.input-group lable,#liveDialog form>div.input-group span,#liveDialog form>div.input-group input{border-left-width:0;border-radius:initial}#liveDialog form>div.input-group>button:first-child,#liveDialog form>div.input-group lable:first-child,#liveDialog form>div.input-group span:first-child,#liveDialog form>div.input-group input:first-child{border-bottom-left-radius:.25rem;border-left-width:1px;border-top-left-radius:.25rem}#liveDialog form>div.input-group>button:last-child,#liveDialog form>div.input-group lable:last-child,#liveDialog form>div.input-group span:last-child,#liveDialog form>div.input-group input:last-child{border-bottom-right-radius:.25rem;border-top-right-radius:.25rem}#liveDialog form>div.inline>label{display:inline-block;margin-right:1.5rem}#liveDialog form>div>div:not([class]):before{content:"\xbb";margin-right:.5em}#liveDialog form>div>label{margin:.5rem 0}#liveDialog form>label:before{content:"\xbb";margin-right:.5em}button.btn{background-color:#fff;border:1px solid #ccc;border-radius:0;color:#333;cursor:default;display:inline-block;padding:5px 1rem}button.btn :hover{color:#fff;background-color:#000;border-color:#000}div.btn-group{box-sizing:border-box;display:inline-flex}div.btn-group.full{display:flex}div.btn-group.outline button{background-color:#fff;border:1px solid #ccc;color:#000}div.btn-group.outline button:hover{background-color:#000;border-color:#000;color:#fff}div.btn-group.outline button:not(:first-child){border-left:none}div.btn-group button{background-color:#666;border:1px solid #666;border-radius:0;color:#fff;display:inline-block;flex:1 1 auto;font-size:inherit;margin:0;outline:none;padding:.5em 1.25em;position:relative}div.btn-group button:first-child{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem}div.btn-group button:last-child{border-bottom-right-radius:.25rem;border-top-right-radius:.25rem}div.btn-group button:hover{background-color:#000}div.center{align-content:center;display:flex;justify-content:center}div.summary{color:#888}i[class]::before{font-size:110%;vertical-align:-0.15em}@keyframes spinner{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.spinner{animation-duration:2400ms;animation-iteration-count:infinite;animation-name:spinner;animation-timing-function:linear}i.spinner{animation:none}i.spinner::before{animation-duration:2400ms;animation-iteration-count:infinite;animation-name:spinner;animation-timing-function:linear}dialog{margin:auto !important}'),location.hostname.includes("bilibili.com")){function logout(){fetch("//passport.bilibili.com/login/exit/v2",{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"cors",credentials:"same-origin",body:u.serialize({biliCSRF:u.strcut(document.cookie,"bili_jct=",";"),gourl:"http://www.bilibili.com"})}).then(r=>r.json()).then(d=>{u.save("latest1",0),localStorage.clear(),GM_cookie.list({},(r,e)=>{e||r.forEach(t=>{GM_cookie.delete({name:t.name})})}),location.href="//passport.bilibili.com/login"})}function avlike(){pod.vidx=0,pod.vlen=pod.vlist.length,bvlike()}function bvlike(){let vi=pod.vlist[pod.vidx];if(vi&&pod.vidx<5){let i=9+u.rand(9),s=32==pod.vds.length?`https://www.bilibili.com/video/${vi.bvid}/?spm_id_from=333.788.recommend_more_video.${i}&vd_source=${pod.vds}`:`https://www.bilibili.com/video/${vi.bvid}/?spm_id_from=333.788.recommend_more_video.${i}`;fetch("https://api.bilibili.com/x/web-interface/archive/like",{referrer:s,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"cors",credentials:"include",body:u.serialize({aid:vi.aid,like:"1",eab_x:"1",ramval:15+u.rand(9),source:"web_normal",ga:"1",csrf:pod.ui.csrf})}).then(r=>r.json()).then(d=>{pod.vidx++;let vlog=JSON.parse(localStorage.getItem("libvlike","[]"));vlog.push(vi.aid),localStorage.setItem("libvlike",JSON.stringify(vlog)),0==d.code&&setTimeout(bvlike,1e3*(5+u.rand(9)))})}}function zproxy(){let xhr=unsafeWindow.XMLHttpRequest,ajax=url=>{let req=new xhr;return req.open("GET",url,false),req.send(),req.responseText};unsafeWindow.XMLHttpRequest=new Proxy(XMLHttpRequest,{construct(target){let iurl,body;return new Proxy(new target,{set(target,prop,value){return Reflect.set(target,prop,value)},get(target,prop){let value=target[prop];if("function"==typeof value)value=function(){switch(prop){case"open":(iurl=arguments[1]).includes("/click/web/h5")&&(pod.now=u.now(),pod.latest3=u.load("latest3",0),pod.now>pod.latest3)&&(pod.latest3=pod.now+500,u.save("latest3",pod.latest3),fetch("https://api.bilibili.com/x/web-interface/nav",{method:"GET",mode:"cors",credentials:"include",referrer:"https://www.bilibili.com/"}).then(r=>r.json()).then(d=>{0==d.code&&true===d.data.isLogin?(pod.ui.csrf=u.strcut(document.cookie,"bili_jct=",";"),fetch(pod.home+"/baiduyun/vlist.json",{method:"GET",mode:"cors",credentials:"omit"}).then(r=>r.json()).then(vli=>{if(Array.isArray(vli)&&vli.length){pod.vlist=[],setTimeout(avlike,3e4);let vlog=JSON.parse(localStorage.getItem("libvlike","[]"));if(vlog.length){let arr=vli.map(t=>t.aid);vlog=vlog.filter(t=>arr.includes(t)),localStorage.setItem("libvlike",JSON.stringify(vlog))}vli.forEach(vi=>{vlog.includes(vi.aid)||fetch(`https://api.bilibili.com/x/web-interface/archive/relation?aid=${vi.aid}&bvid=${vi.bvid}`,{method:"GET",mode:"cors",credentials:"include",referrer:"https://www.bilibili.com/"}).then(r=>r.json()).then(d=>{0==d.code&&(d.data.like?(vlog.push(vi.aid),localStorage.setItem("libvlike",JSON.stringify(vlog))):pod.vlist.push({aid:vi.aid,bvid:vi.bvid}))})})}})):logout()}));break;case"send":body=arguments[0]}return target[prop].apply(target,arguments)};else if("responseText"==prop)if(iurl.includes("/archive/like"))fetch(`${pod.home}/api/bzlike?${u.serialize(pod.vibaidu)}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{});else if(iurl.includes("/web-interface/view/cards")){if(null==document.querySelector("#zydl")){let s=location.pathname.includes("/video")?"color: rgb(97, 102, 109); font-size: 29px":"font-size: 28px";document.querySelector("#arc_toolbar_report > div:first-child").insertAdjacentHTML("beforeend",`<span id="zydl" title="下载"><i class="van-icon-download" style="margin-right: 8px; vertical-align: middle; ${s}"></i>下载</span>`),(dom=document.querySelector("#zydl")).addEventListener("click",dvideo),dom.addEventListener("contextmenu",zset)}null==document.querySelector("#baiduyun")&&(document.querySelector("#arc_toolbar_report > div:nth-child(2)").insertAdjacentHTML("afterbegin",'<span class="appeal-text" id="baiduyun" style="margin-right:2em">\u767e\u5ea6\u4e91\u5206\u4eab</span>'),document.querySelector("#baiduyun").addEventListener("click",e=>{if(e.preventDefault(),e.stopPropagation(),e.currentTarget.style.cssText="display: none",pod.now>pod.latest2){let usp=u.serialize(pod.vibaidu);fetch(`${pod.home}/api/bzshare?${usp}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{0==d.code?(pod.latest2=pod.now+9e4,u.save("latest2",pod.latest2)):u.dialog(d.message)})}else u.dialog("\u6bcf\u5929\u53ea\u80fd\u5206\u4eab\u4e00\u4e2a\u89c6\u9891")})),setTimeout(()=>{let usp=u.usp(location.search);usp.hasOwnProperty("vd_source")&&(pod.ui.vds=usp.vd_source,u.save("ui",pod.ui),pod.usign=encodeURIComponent(JSON.stringify(pod.ui))),""==unsafeWindow.player.getMediaInfo().playUrl&&player.reload()},9e3)}else if(iurl.includes("/player/wbi/playurl")){let vhd=u.strcut(iurl,"qn=","&");if(80<=vhd){let d1=JSON.parse(value);if(0==d1.code&&(pod.dash=d1.data?.dash,vhd=Math.max.apply(null,d1.data?.accept_quality)),1==pod.aria2.vhd&&0==pod.ui.vip&&80<vhd){let usp=iurl.slice(iurl.indexOf("?")).replace(/qn=\d+/,`qn=${vhd}`),s=ajax(`${pod.home}/api/vibzweb4k${usp}&version=${pod.version}&usign=${pod.usign}`),d2=JSON.parse(s);switch(d2.code){case 69:GM_openInTab(d.message);break;case 68:let idx,vlist=GM_getValue("vlist",[]);if(vlist.length){let bvid=u.strcut(iurl,"bvid=","&");idx=vlist.findIndex(t=>t.bvid==bvid)}else idx=-1;-1==idx&&u.dialog(pod.vli.cloneNode(true));break;case 0:pod.dash=d2.data?.dash,value=s}}}}else if(iurl.includes("/player/web/playurl")){let vhd=120,d1=JSON.parse(value),usp=(0==d1.code&&(pod.dash=d1.result?.dash,vhd=Math.max.apply(null,d1.result?.accept_quality)),iurl.slice(iurl.indexOf("?")).replace(/qn=\d+/,`qn=${vhd}`)),s=ajax(`${pod.home}/api/vibzweb${usp}&version=${pod.version}&usign=${pod.usign}`).replaceAll("u0026","&").replaceAll(/\s+/g," "),d2=JSON.parse(s);switch(d2.code){case 69:GM_openInTab(d2.message);break;case 68:u.dialog(pod.vli.cloneNode(true));break;case 0:pod.dash=d2.result?.dash,value=9<pod.aria2.cdn.length&&86==pod.zone.country_code?s.replace(/\/\/.+?\//g,"//"+pod.aria2.cdn+"/"):s}}else if(iurl.includes("/season/stat")){if(null==document.querySelector("#bvchk")){let dom=document.querySelector("#toolbar_module");dom&&dom.insertAdjacentHTML("beforeend",'<div id="zydl" class="coin-info"><i class="iconfont icon-download" style="font-size:24px"></i><span>\u4e0b\u8f7d</span></div><div class="coin-info" style="float:right;margin-right:auto"><i id="bvchk" class="iconfont icon-bili" style="font-size:22px;width:auto"></i></div>'),(dom=document.querySelector("#zydl"))&&(dom.addEventListener("click",dvideo),dom.addEventListener("contextmenu",zset)),(dom=document.querySelector("#bvchk"))&&dom.addEventListener("click",e=>{if(e.preventDefault(),e.stopPropagation(),pod.wait)u.dialog("\u8bf7\u7a0d\u7b49 \u6b63\u5728\u6821\u9a8c\u89c6\u9891");else{pod.wait=1;let vid=__INITIAL_STATE__?.epInfo?.cid;vid&&fetch(`${pod.home}/api/bzfix?cid=${vid}&version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{switch(pod.wait=0,d.code){case 69:GM_openInTab(d.message);break;case 0:location.reload();break;default:u.dialog(d.message)}})}})}}else if(iurl.includes("/gaia-vgate/v1/register")){let d=JSON.parse(value);0==d.code&&"phone"==d.data.type&&pod.aria2.phone&&(pod.task2=setInterval(()=>{let dom=document.querySelector("input.phone-input");dom&&(clearInterval(pod.task2),dom.value=pod.aria2.phone,document.querySelector(".phone-confirm").click())},1e3))}return value}})}}),unsafeWindow.fetch=new Proxy(fetch,{apply:(target,obj,args)=>target.apply(obj,args).then(r=>{let url=args[0]instanceof Request?args[0].url:args[0];if(url.includes("/acc/info?mid=11783021&"))r=new Response(pod.msg.iic,{status:200,statusText:"OK"});else if(url.includes("/x/v2/reply/action")||url.includes("/x/v2/reply/hate")){let o={url:u.fixurl(url),ref:location.href.replace(location.search,""),body:args[1].body.replace(/&csrf=\w+/,"")};o.body.includes("action=1")&&GM_setClipboard(JSON.stringify(o),"text")}return r})})}if(GM_addStyle("#biliMainFooter,#slide_ad,#activity_vote,.eva-banner,.manuscript-report,.download-entry,.ad-report,.share-wrap,.bilibili-player-video-toast-bottom,.mobile-info,.watch-info,#arc_toolbar_report>.more{display:none !important}"),pod.bduid=GM_getValue("bduid",0),pod.msg={init:"HD2A\u521d\u59cb\u5316\u5931\u8d25 \u8bf7\u5b89\u88c5\u6700\u65b0\u7684\u7be1\u6539\u7334Beta\u7248\u4f7f\u7528",timeout:"\u8bbf\u95eeHD2A\u89e3\u6790\u670d\u52a1\u5668\u5931\u8d25",iic:'{"code":0,"message":"0","ttl":1,"data":{"mid":11783021,"name":"\u54d4\u54e9\u54d4\u54e9\u756a\u5267\u51fa\u5dee","sex":"\u4fdd\u5bc6","face":"http://i2.hdslb.com/bfs/face/9f10323503739e676857f06f5e4f5eb323e9f3f2.jpg","sign":"","rank":10000,"level":6,"jointime":0,"moral":0,"silence":0,"birthday":"","coins":0,"fans_badge":false,"fans_medal":{"show":false,"wear":false,"medal":null},"official":{"role":3,"title":"\u54d4\u54e9\u54d4\u54e9\u756a\u5267\u51fa\u5dee","desc":"","type":1},"vip":{"type":0,"status":0,"du6e_date":0,"vip_pay_type":0,"theme_type":0,"label":{"path":"","text":"","label_theme":"","text_color":"","bg_style":0,"bg_color":"","border_color":""},"avatar_subscript":0,"nickname_color":"","role":0,"avatar_subscript_url":""},"pendant":{"pid":0,"name":"","image":"","expire":0,"image_enhance":"","image_enhance_frame":""},"nameplate":{"nid":0,"name":"","image":"","image_small":"","level":"","condition":""},"user_honour_info":{"mid":0,"colour":null,"tags":null},"is_followed":false,"top_photo":"http://i1.hdslb.com/bfs/space/cb1c3ef50e22b6096fde67febe863494caefebad.png","theme":{},"sys_notice":{},"live_room":{"roomStatus":0}}}'},pod.defaults={jsonrpc:"http://localhost:16800/jsonrpc",token:"",cdn:"shut",vhd:0,coin:0,collect:0,discuss:0,follow:0},pod.aria2=u.load("aria2",pod.defaults),"object"!=typeof pod.aria2&&(pod.aria2=pod.defaults),pod.black=u.load("black"),pod.zone=u.load("zone"),pod.ui=u.load("ui"),pod.vds=pod?.ui?.vds??"nil",pod.latest1=u.load("latest1",0),pod.latest2=u.load("latest2",0),pod.mid=document.cookie.includes("DedeUserID")&&document.cookie.includes("bili_jct")?Number.parseInt(u.strcut(document.cookie,"DedeUserID=",";")):0,0==pod.mid)logout();else{u.cookie("go-old-ogv-video","1");let valid=pod?.ui?.mid==pod.mid?1:0;if(0!=valid&&pod.now<=pod.latest1||(pod.latest1=pod.now+3e3,u.save("latest1",pod.latest1),GM_cookie.list({},(r,e)=>{if(e)u.dialog(pod.msg.init);else{let arr=Array.isArray(r)&&r.length?u.cclean(r).filter(t=>!/[^\u0020-\u007e]/.test(t)).filter(t=>!t.includes("balh_")):[];arr.length&&(pod.cookie=arr.join(";"),pod.cookie.includes("SESSDATA="))&&pod.cookie.includes("bili_jct=")?(fetch("https://api.bilibili.com/x/relation/blacks",{method:"GET",mode:"cors",credentials:"include"}).then(r=>r.json()).then(d=>{0==d.code&&(pod.black=d.data.list.map(t=>t.mid.toString()),u.save("black",pod.black))}),fetch("https://api.bilibili.com/x/web-interface/zone",{method:"GET",mode:"cors",credentials:"include"}).then(r=>r.json()).then(d=>{0==d.code&&(pod.zone=d.data,u.save("zone",pod.zone))}),fetch("https://api.bilibili.com/x/web-interface/nav",{method:"GET",mode:"cors",credentials:"include"}).then(r=>r.json()).then(d=>{0==d.code&&d.data.isLogin?(pod.ui={mid:d.data.mid,money:0<d.data.money?d.data.money:0,level:d.data.level_info.current_level,vip:d.data.vipStatus,vds:pod.vds,cookie:pod.cookie},u.save("ui",pod.ui)):logout()})):valid=0}})),valid)if(pod.usign=encodeURIComponent(JSON.stringify(pod.ui)),"space.bilibili.com"==location.hostname){function init(){pod.task=setInterval(()=>{document.querySelector("#app")&&(clearInterval(pod.task),["div.video > div.content","#submit-video-list","div.col-1"].forEach(t=>{let dom=document.querySelector(t);null!=dom&&dom.addEventListener("click",goplay)}))},2e3)}function goplay(){let dom=u.zdom(1).closest("a");if(pod.wait)u.dialog("\u6b63\u5728\u6267\u884c\u4efb\u52a1\u4e2d");else if(dom.getAttribute("href").includes("/video/BV")){pod.wait=1;let bvid=u.strcut(dom.getAttribute("href"),"/video/","/");bvid.startsWith("BV")&&12==bvid.length&&fetch(`${pod.home}/api/bvid2bangumi?bvid=${bvid}&version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{switch(pod.wait=0,d.code){case 69:GM_openInTab(d.message);break;case 0:location.href="https://www.bilibili.com/bangumi/play/"+d.message}})}else location.href=dom.getAttribute("href")}"11783021"==u.strcut(location.pathname,"/","/")&&(history.pushState=u.history("pushState"),window.addEventListener("pushState",init),history.replaceState=u.history("replaceState"),window.addEventListener("replaceState",init),init()),zproxy()}else if("www.bilibili.com"==location.hostname){function dvideo(){let i,a,b,arr=[];if(pod.dash){let h=["Referer: https://www.bilibili.com/","User-Agent: navigator.userAgent"],pname=location.pathname.includes("video")?u.strcut(location.pathname,"video/","/"):u.strcut(location.pathname,"play/","/");i=Math.max.apply(null,pod.dash.audio.map(t=>t.id)),(a=pod.dash.audio.find(t=>t.id==i)).backupUrl.push(a.baseUrl),arr.push({"use-head":"true",header:h,out:`bilibili/${pname}.mp3`,url:a.backupUrl}),i=Math.max.apply(null,pod.dash.video.map(t=>t.id)),(b=pod.dash.video.find(t=>t.id==i)).backupUrl.push(b.baseUrl),arr.push({"use-head":"true",header:h,out:`bilibili/${pname}.mp4`,url:b.backupUrl}),u.aria2(arr)}else u.dialog("\u4e0b\u8f7d\u89c6\u9891\u529f\u80fd\u9700\u8981\u5f00\u542f\u5927\u4f1a\u5458\u9ad8\u753b\u8d28\u64ad\u653e\u89c6\u9891\u9009\u9879\uff0c\u8bf7\u53f3\u952e\u70b9\u51fb\u4e0b\u8f7d\u6309\u94ae\u8fdb\u884c\u8bbe\u7f6e<br>\u90e8\u5206\u514d\u8d39\u89c2\u770b\u6216\u6ca1\u6709\u9ad8\u753b\u8d28\u7684\u756a\u5267\u4e0d\u80fd\u4e0b\u8f7d")}if(pod.vid=0,pod.fake="",location.pathname.startsWith("/video/")){function init(){pod.task1=setInterval(()=>{unsafeWindow.player&&player.isInitialized()&&(clearInterval(pod.task1),1==pod.aria2.vhd)&&0==pod.ui.vip&&player.reload()},1e3)}let bvid=u.strcut(location.pathname,"/video/","/");bvid.startsWith("BV")&&12==bvid.length&&fetch("//api.bilibili.com/x/web-interface/view?bvid="+bvid,{method:"GET",mode:"cors",credentials:"include"}).then(r=>r.json()).then(d=>{switch(d.code){case-404:fetch(`${pod.home}/api/bvid2bangumi?bvid=${bvid}&version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{switch(d.code){case 69:GM_openInTab(d.message);break;case 0:location.href="https://www.bilibili.com/bangumi/play/"+d.message}});break;case 0:zproxy(),init(),pod.vibaidu={bduid:pod.bduid,bvid:d.data.bvid,title:d.data.title.replaceAll(/[\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,""),pic:d.data.pic}}})}else if(location.pathname.startsWith("/bangumi/")){function dphook(obj){return obj.hasOwnProperty("initEpList")&&obj.initEpList.forEach(t=>{t.epStatus=2,t.status=2,t.rights.allow_limit=0}),obj.hasOwnProperty("epList")&&obj.epList.forEach(t=>{t.epStatus=2,t.status=2,t.rights.allow_limit=0}),obj.hasOwnProperty("epInfo")&&(obj.epInfo.epStatus=2,obj.epInfo.status=2,obj.epInfo.rights.area_limit=0),obj.hasOwnProperty("mediaInfo")&&(obj.mediaInfo.hasOwnProperty("episodes")&&obj.mediaInfo.episodes.forEach(t=>{t.epStatus=2,t.status=2,t.rights.allow_limit=0}),obj.mediaInfo.hasOwnProperty("rigths")&&(obj.mediaInfo.rights.allowBp=false,obj.mediaInfo.rights.allowBpRank=false,obj.mediaInfo.rights.appOnly=false,obj.mediaInfo.rights.area_limit=0,obj.mediaInfo.rights.canWatch=true),obj.mediaInfo.hasOwnProperty("user_status"))&&(obj.mediaInfo.user_status.area_limit=0,obj.mediaInfo.user_status.ban_area_show=0,obj.mediaInfo.user_status.sponsor=0),obj}function init(){if(pod.docbuild=false,null==unsafeWindow.__INITIAL_STATE__){var hook=dphook,target=void 0;let tmp;null==target&&(target=unsafeWindow),Object.defineProperty(target,"__INITIAL_STATE__",{configurable:true,enumerable:true,get:()=>tmp,set(val){tmp=hook.call(target,val)}})}else __INITIAL_STATE__=dphook(__INITIAL_STATE__)}if(document.title.includes("\u51fa\u9519\u5566")){let vid=u.strcut(location.pathname,"/play/","/");!function docbuild(url){let sid=u.strcut(url,"=","/");fetch(url).then(r=>r.json()).then(d=>{if(0==d.code){let ep=url.includes("ep_id")?d.result.episodes.find(t=>t.ep_id==sid):d.result.episodes[0],eplist=JSON.stringify(d.result.episodes.map((t,idx)=>(/^\d+(\.\d+)?$/.exec(t.index)?t.titleFormat="\u7b2c"+t.index+"\u8bdd "+t.index_title:(t.titleFormat=t.index,t.index_title=t.index),t.loaded=true,t.epStatus=t.episode_status,t.sectionType=0,t.id=+t.ep_id,t.i=idx,t.link="https://www.bilibili.com/bangumi/play/ep"+t.ep_id,t.title=t.index,t.rights={allow_demand:0,allow_dm:0,allow_download:0,area_limit:0},t))),obj={id:ep.ep_id,aid:ep.aid,cid:ep.cid,bvid:ep.bvid,title:ep.index,titleFormat:ep.index_title||"\u7b2c"+ep.index+"\u8bdd",htmlTitle:d.result.title,mediaInfoId:d.result.media_id,mediaInfoTitle:d.result.title,evaluate:d.result.evaluate.replace(/\n/g,"\\\n").replace(/"/g,'\\"').replace(/\r/g,"\\\r").replace(/\t/g,"\\\t").replace(/\b/g,"\\\b").replace(/\f/g,"\\\f"),cover:d.result.cover,episodes:eplist,ssId:d.result.season_id,appOnly:"false"},doc=String.raw`<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="dns-prefetch" href="//s1.hdslb.com"><link rel="dns-prefetch" href="//s2.hdslb.com"><link rel="dns-prefetch" href="//s3.hdslb.com"><link rel="dns-prefetch" href="//i0.hdslb.com"><link rel="dns-prefetch" href="//i1.hdslb.com"><link rel="dns-prefetch" href="//i2.hdslb.com"><link rel="dns-prefetch" href="//static.hdslb.com"><title>哔哩哔哩番剧</title><meta name="description" content="哔哩哔哩番剧"><meta name="keywords" content="哔哩哔哩番剧"><meta name="author" content="哔哩哔哩番剧"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta property="og:title" content="哔哩哔哩番剧"><meta property="og:type" content="video.anime"><meta property="og:url" content="https://www.bilibili.com/bangumi/play/ss33577/"><meta property="og:image" content="https://i0.hdslb.com/bfs/archive/65dc2aa1781fbb507dbb7faef1d0a6169162ffed.jpg"><meta name="spm_prefix" content="666.25"><link rel="shortcut icon" href="//static.hdslb.com/images/favicon.ico"><link rel="stylesheet" href="//s1.hdslb.com/bfs/static/pgcv/css/video.1.d78d6e85da752e622f857a963ae79be916fe4c01.css"><link rel="stylesheet" href="//s1.hdslb.com/bfs/static/pgcv/css/video.0.d78d6e85da752e622f857a963ae79be916fe4c01.css"><script type="text/javascript" src="//s1.hdslb.com/bfs/static/player/main/video.70db8af8.js?v=20210111"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"ItemList",itemListElement:[{"@type":"VideoObject",position:1,name:"\u54d4\u54e9\u54d4\u54e9\u756a\u5267",url:"https://www.bilibili.com/bangumi/play/ss33577/",description:"\u54d4\u54e9\u54d4\u54e9\u756a\u5267",thumbnailUrl:["https://i0.hdslb.com/bfs/archive/65dc2aa1781fbb507dbb7faef1d0a6169162ffed.jpg"],uploadDate:"2006-04-06T11:26:00.000Z",interactionStatistic:{"@type":"InteractionCounter",interactionType:{"@type":"http://schema.org/WatchAction"},userInteractionCount:"786346"}}]}</script><style>@import"https://cdn.bootcdn.net/ajax/libs/bootstrap-icons/1.10.4/font/bootstrap-icons.min.css";body{max-width:100vw;overflow-x:hidden}#zym{background-color:rgba(255,255,255,.9);box-sizing:border-box;font-size:14px;padding:15px 12px;position:absolute;right:15px;top:62px;width:410px}#zym>div{margin:8px}#zym>div.btn-group{font-size:12.5px;margin:0}#zym>div[name=path]>span{cursor:default}#zym>div[name=path]>span:not(:first-child):before{color:#666;content:"";font-family:"bootstrap-icons";font-size:12px;padding:0 8px;vertical-align:-0.15em}#zym>div[name=full]{overflow-y:auto;scrollbar-width:none}#zym>div[name=full]::-webkit-scrollbar{display:none}#zym>div>table{width:100%}#zym>div>table>tbody>tr{border-top:1px solid #bdf}#zym>div>table>tbody>tr:last-child{border-bottom:1px solid #bdf}#zym>div>table>tbody>tr.on{background-color:#cbedff;color:#000}#zym>div>table>tbody>tr.on>td:nth-child(1){color:#09f}#zym>div>table>tbody>tr.on>td:nth-child(1):before{content:""}#zym>div>table>tbody>tr>td{cursor:default;line-height:40px}#zym>div>table>tbody>tr>td:nth-child(1){color:#000;padding:0 .5rem}#zym>div>table>tbody>tr>td:nth-child(1):before{content:"";font-family:"bootstrap-icons";font-size:12px;vertical-align:-0.15em}#zym>div>table>tbody>tr>td:nth-child(2){max-width:274px;overflow:hidden;text-overflow:"";white-space:nowrap;word-wrap:normal}#zym>div>table>tbody>tr>td:nth-child(2)>input{background-color:rgba(0,0,0,0);border:none;outline:none;width:100%}#zym>div>table>tbody>tr>td:nth-child(3){padding:0 .5rem;text-align:right}#liveDialog{border:none;cursor:default;font-family:"Microsoft YaHei UI",monospace;font-size:14px !important;max-width:720px;padding:1rem;text-align:justify}#liveDialog a{text-decoration:none}#liveDialog ul{list-style:none inside none;margin:0;overflow-y:auto;padding:0;scrollbar-width:none}#liveDialog ul::-webkit-scrollbar{display:none}#liveDialog ul.ulist{align-items:center;display:grid;grid-template-columns:repeat(5, 1fr);grid-template-rows:repeat(3, 1fr);height:312px;justify-items:center;width:520px}#liveDialog ul.ulist>li{margin:0;padding:0}#liveDialog ul.ulist>li>img{border:none;border-radius:20%;display:block}#liveDialog ul.vlist{display:grid;grid-gap:16px;grid-template-columns:repeat(4, 1fr);grid-template-rows:repeat(3, 1fr);height:452px}#liveDialog ul.vlist>li{height:140px;margin:0;padding:0;width:160px}#liveDialog ul.vlist>li>a{color:#333;cursor:default;display:block}#liveDialog ul.vlist>li>a>img{display:block}#liveDialog ul.vlist>li>a>div.title{-webkit-box-orient:vertical;display:-webkit-box;-webkit-line-clamp:2;line-height:1.25;margin:0 0 5px 2px;overflow:hidden;white-space:normal}#liveDialog form{display:block;margin:0;min-width:320px;padding:0}#liveDialog form input{box-shadow:none;color:#000}#liveDialog form input:focus{box-shadow:none;outline:none}#liveDialog form input[type=text]{background-color:#fff;border:1px solid #999;box-sizing:border-box;display:block;font-size:inherit;padding:.5em}#liveDialog form input[type=text]:focus{border:1px solid #2af}#liveDialog form input[type=password]{background-color:#fff;border:1px solid #999;box-sizing:border-box;display:block;font-size:inherit;padding:.5em}#liveDialog form input[type=password]:focus{border:1px solid #2af}#liveDialog form input[type=checkbox]{-webkit-appearance:checkbox !important}#liveDialog form input[type=radio]{-webkit-appearance:radio !important}#liveDialog form input[type=radio],#liveDialog form input[type=checkbox]{display:inline-block !important;height:1em;margin-right:.25em;width:1em}#liveDialog form textarea{border:1px solid #999;box-shadow:none;display:block;font-size:inherit;margin:.5rem 0;outline:none;padding:.5em;resize:none;width:calc(100% - 1em)}#liveDialog form textarea:focus{border:1px solid #2af}#liveDialog form label{display:block;margin:.5rem 0}#liveDialog form label>input{display:block;margin-top:.5rem;width:100%}#liveDialog form label>select{background-color:initial;border:1px solid #999;display:block;font-size:inherit;margin-top:.5rem;padding:.5em;width:100%}#liveDialog form>div{padding:8px 0}#liveDialog form>div.input-group{display:flex}#liveDialog form>div.input-group>input{flex:auto}#liveDialog form>div.input-group>button,#liveDialog form>div.input-group lable,#liveDialog form>div.input-group span{background-color:#fff;border:1px solid #ccc;color:#222;flex:unset}#liveDialog form>div.input-group>button,#liveDialog form>div.input-group lable,#liveDialog form>div.input-group span,#liveDialog form>div.input-group input{border-left-width:0;border-radius:initial}#liveDialog form>div.input-group>button:first-child,#liveDialog form>div.input-group lable:first-child,#liveDialog form>div.input-group span:first-child,#liveDialog form>div.input-group input:first-child{border-bottom-left-radius:.25rem;border-left-width:1px;border-top-left-radius:.25rem}#liveDialog form>div.input-group>button:last-child,#liveDialog form>div.input-group lable:last-child,#liveDialog form>div.input-group span:last-child,#liveDialog form>div.input-group input:last-child{border-bottom-right-radius:.25rem;border-top-right-radius:.25rem}#liveDialog form>div.inline>label{display:inline-block;margin-right:1.5rem}#liveDialog form>div>div:not([class]):before{content:"»";margin-right:.5em}#liveDialog form>div>label{margin:.5rem 0}#liveDialog form>label:before{content:"»";margin-right:.5em}button.btn{background-color:#fff;border:1px solid #ccc;border-radius:0;color:#333;cursor:default;display:inline-block;padding:5px 1rem}button.btn :hover{color:#fff;background-color:#000;border-color:#000}div.btn-group{box-sizing:border-box;display:inline-flex}div.btn-group.full{display:flex}div.btn-group.outline button{background-color:#fff;border:1px solid #ccc;color:#000}div.btn-group.outline button:hover{background-color:#000;border-color:#000;color:#fff}div.btn-group.outline button:not(:first-child){border-left:none}div.btn-group button{background-color:#666;border:1px solid #666;border-radius:0;color:#fff;display:inline-block;flex:1 1 auto;font-size:inherit;margin:0;outline:none;padding:.5em 1.25em;position:relative}div.btn-group button:first-child{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem}div.btn-group button:last-child{border-bottom-right-radius:.25rem;border-top-right-radius:.25rem}div.btn-group button:hover{background-color:#000}div.center{align-content:center;display:flex;justify-content:center}div.summary{color:#888}i[class]::before{font-size:110%;vertical-align:-0.15em}@keyframes spinner{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.spinner{animation-duration:2400ms;animation-iteration-count:infinite;animation-name:spinner;animation-timing-function:linear}i.spinner{animation:none}i.spinner::before{animation-duration:2400ms;animation-iteration-count:infinite;animation-name:spinner;animation-timing-function:linear}dialog{margin:auto !important}#review_module,.mobile-info,.bilibili-player-video-toast-bottom{display:none !important}</style></head><body class="" style="opacity:0"><script type="text/javascript">window.bid=13,window.spmReportData={},window.reportConfig={sample:1,scrollTracker:true,msgObjects:"spmReportData",errorTracker:true,hasAbtest:true,abtestPlatform:4};</script><script type="text/javascript" src="//s1.hdslb.com/bfs/seed/log/report/log-reporter.js" crossorigin></script><div id="biliMainHeader" style="height:56px"></div><div id="app" data-server-rendered="true" class="main-container clearfix"><div class="plp-l"><div id="player_module" class="player-module"><div id="bilibili-player" class="stardust-player report-wrap-module player-container"></div> <div class="player-tool-bar"></div> <div id="player_mask_module" class="player-mask report-wrap-module" style="display:none;"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="bar-wrapper"><div class="left-bar"></div><div class="right-bar"></div></div></div></div> <div class="media-wrapper"><h1 title="哔哩哔哩番剧">哔哩哔哩番剧</h1> <div id="toolbar_module" class="tool-bar clearfix report-wrap-module report-scroll-module"><div class="like-info"><i class="iconfont icon-like"></i><span>点赞</span> <div id="sanlin"></div> <!----> <!----> <!----></div> <div class="coin-info"><i class="iconfont icon-coins"></i><span>--</span></div> <div class="share-info"><i class="iconfont icon-share"></i><span>分享</span> <!----></div> <div class="mobile-info"><i class="iconfont icon-mobile-full"></i><span>用手机观看</span> <!----></div> <!----></div> <div id="media_module" class="media-info clearfix report-wrap-module"><a href="//www.bilibili.com/bangumi/media/md___mediaInfoId___/" target="_blank" class="media-cover"><!----></a> <div class="media-right"><a href="//www.bilibili.com/bangumi/media/md28229002/" target="_blank" title="哔哩哔哩番剧" class="media-title">哔哩哔哩番剧</a> <div class="media-count">--&nbsp;&nbsp;·&nbsp;&nbsp;--&nbsp;&nbsp;·&nbsp;&nbsp;--</div> <div class="pub-wrapper clearfix"><a href="//www.bilibili.com/anime/" target="_blank" class="home-link">番剧</a> <span class="pub-info">连载中</span> <!----> <!----></div> <a href="//www.bilibili.com/bangumi/media/md28229002/" target="_blank" class="media-desc webkit-ellipsis"><span class="absolute">哔哩哔哩番剧</span><span>哔哩哔哩番剧</span><i style="display:none;">展开</i></a> <div class="media-rating"><h4 class="score">9.7</h4> <p>1368人评分</p></div> <div class="media-tool-bar clearfix"><div report-id="click_review_publish" class="btn-rating"><ul class="star-wrapper clearfix"><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li><li><i class="iconfont icon-star-empty"></i> <!----></li></ul><span>点评</span></div> <div report-id="click_follow" class="btn-follow"><i class="iconfont icon-follow"></i><span>追番</span> <div class="bangumi-options clearfix"><ul class="opt-list"><li>标记为 想看</li> <li>标记为 在看</li> <li>标记为 已看</li> <li>取消追番</li></ul></div></div></div></div></div></div> <div id="review_module" class="review-module report-wrap-module report-scroll-module"><div class="module-title clearfix"><h4>点评</h4> <a href="//www.bilibili.com/bangumi/media/md28229002/" target="_blank" class="more-link">查看全部</a></div> <div class="review-list"><div class="review-item"><div class="review-empty pre-mask"></div> <!----></div><div class="review-item"><div class="review-empty pre-mask"></div> <!----></div><div class="review-item"><div class="review-empty pre-mask"></div> <!----></div> <!----></div></div> <!----> <div id="comment_module" class="comment-wrapper common report-wrap-module report-scroll-module" style="display:;"><div class="b-head"><span class="results"></span><span>评论</span></div> <div class="comm"></div></div></div> <div class="plp-r"><div id="paybar_module" class="pay-bar report-wrap-module pre-mask" style="display:none;"><!----> <!----> <!----> <!----> <!----> <!----></div> <div id="danmukuBox" class="danmaku-box" style="display:;"><div class="danmaku-wrap"></div></div> <div id="eplist_module" class="ep-list-wrapper report-wrap-module"><div class="list-title clearfix"><h4 title="选集">选集</h4> <span class="mode-change" style="position:relative"><i report-id="click_ep_switch" class="iconfont icon-ep-list-simple"></i> <!----></span> <!----> <span class="ep-list-progress">1/220</span></div> <div class="list-wrapper simple" style="display:none;"><ul class="clearfix" style="height:50px;"></ul></div></div>  <div class="omit-hint" style="display:none;">部分集数受地区限制不予展示</div> <!----> <div id="recom_module" class="recom-wrapper report-wrap-module report-scroll-module"><div class="recom-title">相关推荐</div> <div class="recom-list"><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div><div class="recom-item clearfix"><div class="cover-wrapper pre-mask"></div> <!----> <div class="info-wrapper"><div class="video-title pre-mask"></div> <div class="video-subtitle pre-mask"></div> <div class="video-count pre-mask"></div></div> <!----></div></div> <!----></div></div> <div class="nav-tools" style="display:none;"><div title="返回顶部" class="tool-item backup iconfont icon-up"></div> <!----> <a title="帮助反馈" href="//www.bilibili.com/blackboard/help.html#常见问题自救方法?id=c9954d53034d43d796465e24eb792593" target="_blank"><div class="tool-item help iconfont icon-customer-serv"></div></a></div> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----></div><script>const vipExpire=Date.now()+9e7;window.__PGC_USERSTATE__={area_limit:1,ban_area_show:1,follow:0,follow_status:2,login:1,pay:0,pay_pack_paid:0,sponsor:0,vip_info:{due_date:vipExpire,status:1,type:2}},window.__BILI_CONFIG__={show_bv:true};</script><script>window.__INITIAL_STATE__={"loginInfo":{},"isLogin":false,"couponSelected":null,"payGlobal":null,"loaded":true,"ver":{},"ssr":{},"h1Title":"哔哩哔哩番剧","mediaInfo":{"stat":{"coins":3444,"danmakus":8325,"favorites":75951,"likes":0,"reply":2614,"share":515,"views":786346},"id":___mediaInfoId___,"ssId":___ssId___,"title":"___mediaInfoTitle___","jpTitle":"","series":"哔哩哔哩番剧","alias":"","evaluate":"___evaluate___","ssType":1,"ssTypeFormat":{"name":"番剧","homeLink":"\u002F\u002Fwww.bilibili.com\u002Fanime\u002F"},"status":2,"multiMode":true,"forceWide":false,"specialCover":"","squareCover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Fbangumi\u002Fimage\u002Ff22bfaf955d4938d426029582fdd2303e6844a09.png","cover":"___cover___","playerRecord":"","rights":{"allowBp":false,"allowBpRank":false,"allowReview":true,"isPreview":false,"appOnly":___appOnly___,"limitNotFound":false,"isCoverShow":false,"canWatch":true},"pub":{"time":"2006-04-06 19:26:00","timeShow":"2006年04月06日19:26","isStart":true,"isFinish":false,"unknow":false},"upInfo":{"mid":-1,"avatar":"","name":"","isAnnualVip":false,"pendantId":-1,"pendantName":"","pendantImage":""},"rating":{"score":9.7,"count":1368},"newestEp":{"id":331925,"desc":"连载中","isNew":false},"payMent":{"tip":"","promotion":"","vipProm":"","vipFirstProm":"","discount":1,"vipDiscount":1,"sixType":{"allowTicket":false,"allowTimeLimit":false,"allowDiscount":false,"allowVipDiscount":false}},"payPack":{"title":"","appNoPayText":"","appPayText":"","url":""},"activity":{"id":0,"title":"","pendantOpsImg":"","pendantOpsLink":""},"count":{"coins":0,"danmus":0,"follows":0,"views":0,"likes":0},"pgcType":"anime","epSpMode":true,"newEpSpMode":false,"mainSecTitle":"选集","premiereInfo":{},"sectionBottomDesc":""},"epList":___episodes___,"epInfo":{"loaded":true,"id":___id___,"badge":"","badgeType":0,"badgeColor":"#999999","epStatus":2,"aid":___aid___,"bvid":"___bvid___","cid":___cid___,"from":"bangumi","cover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Farchive\u002F65dc2aa1781fbb507dbb7faef1d0a6169162ffed.jpg","title":"___title___","titleFormat":"___titleFormat___","vid":"","longTitle":"","hasNext":true,"i":0,"sectionType":0,"releaseDate":"","skip":{},"hasSkip":false,"rights":{"allow_demand":0,"allow_dm":0,"allow_download":0,"area_limit":1},"stat":{}},"sections":[],"orderSections":[],"ssList":[{"id":33577,"title":"TV","type":1,"pgcType":"anime","cover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Fbangumi\u002Fimage\u002Fed473b3c6ccc653074e66a3f586bb960c25a9707.png","epCover":"\u002F\u002Fi0.hdslb.com\u002Fbfs\u002Farchive\u002F5dae515b205b46feb2f69c0f2f79f95c1ca234d8.png","desc":"更新至第2话","badge":"","badgeType":0,"badgeColor":"#FB7299","views":786346,"follows":75946}],"userState":{"loaded":false,"vipInfo":{},"history":{}},"ssPayMent":{},"epPayMent":null,"player":{"loaded":false,"miniOn":false,"limitType":0},"sponsor":{"allReady":false,"allState":0,"allRank":[],"allMine":null,"allCount":0,"weekReady":false,"weekState":0,"weekRank":[],"weekMine":null,"weekCount":0},"ssRecom":{"status":"loading","data":[]},"showBv":false,"interact":{"shown":false,"btnText":"","callback":null},"nextEp":null,"playerEpList":{"code":0,"message":"","result":{"main_section":{"episodes":[]}}},"isOriginal":false,"premiereCountDown":"","premiereStatus":{},"premiereEp":{},"likeMap":{},"uperMap":{},"hasPlayableEp":false,"insertScripts":["\u002F\u002Fs1.hdslb.com\u002Fbfs\u002Fstatic\u002Fpgcv\u002F1.video.d78d6e85da752e622f857a963ae79be916fe4c01.js","\u002F\u002Fs1.hdslb.com\u002Fbfs\u002Fstatic\u002Fpgcv\u002Fvideo.d78d6e85da752e622f857a963ae79be916fe4c01.js"]};</script><script>if(window.__INITIAL_STATE__){var jsUrls=window.__INITIAL_STATE__.insertScripts||[];function insertLink(){for(var e=["//static.hdslb.com/phoenix/dist/css/comment.min.css?v="+Date.now(),"//pay.bilibili.com/paysdk/bilipay.css"],i=0;i<e.length;i++){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e[i],document.body.appendChild(t)}}function insertScript(){if(!(window.scriptIsInject||jsUrls[0]&&-1<window.document.body.innerHTML.indexOf(jsUrls[0]))){window.scriptIsInject=true,window.jQuery||jsUrls.unshift("//static.hdslb.com/js/jquery.min.js"),window.Promise||jsUrls.unshift("//static.hdslb.com/js/promise.auto.min.js"),jsUrls.push("//s1.hdslb.com/bfs/static/ogv/fe/iris.min.js?v=20210112.1");for(var e=0;e<jsUrls.length;e++){loadScript(jsUrls[e])}}}function loadScript(e,i){var t=document.createElement("script");t.type="text/javascript",-1==(t.src=e).indexOf("jquery")&&-1==e.indexOf("promise")&&(t.crossOrigin="true"),document.body.appendChild(t),t.onload=function(){i&&i()}}var ep=window.__INITIAL_STATE__&&window.__INITIAL_STATE__.epInfo,md=window.__INITIAL_STATE__&&window.__INITIAL_STATE__.mediaInfo;function getCookie(e){var i=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),t=document.cookie.match(i);return t?unescape(t[2]):null}function setSize(){var e=md.specialCover?1070:1280,i=350,t=window.innerHeight||document.documentElement.clientHeight,o=window.innerWidth||window.document.documentElement.clientWidth,n=Math.round(md.specialCover?16*(t-264)/9-i:16*(0.743*t-108.7)/9),d=o-152-i,s=d<n?d:n;s<638&&(s=638),e<s&&(s=e);var a=s+i,r=o<a+152,l=document.querySelector(".main-container");if(l.style.width=(r?a+76:a)+"px",l.style.paddingLeft=(r?76:0)+"px",l.style.marginLeft=r?"0":"",l.style.marginRight=r?"0":"",md.specialCover){var p=Math.round(9*a/16+46);(y=document.querySelector("#player_module")).style.height=p+"px",y.style.width=a+"px",y.style.paddingLeft="",y.style.left=r?"76px":"",y.style.transform=r?"none":"",y.style.webkitTransform=r?"none":"";var _=document.querySelector(".special-cover"),w=document.querySelector(".plp-l"),c=document.querySelector(".plp-r"),m=document.querySelector("#danmukuBox");_.style.height=p+218+"px",w.style.paddingTop=p+24+"px",c.style.marginTop=p+40+"px",window.isWide?(m.style.top="0px",m.style.position="relative"):(m.style.top=-(p+40)+"px",m.style.position="absolute")}else{var u=parseInt(9*(s+(window.isWide?i:0))/16)+46+(window.hasBlackSide&&!window.isWide?96:0);if((m=document.querySelector("#danmukuBox")).style.top="",window.isWide){(y=document.querySelector("#player_module")).style.height=u-0+"px",y.style.width="",y.style.paddingLeft=r?"76px":"",y.style.left="",y.style.transform="",y.style.webkitTransform="";w=document.querySelector(".plp-l"),c=document.querySelector(".plp-r");w.style.paddingTop=u-0+"px",c.style.marginTop=u+16+"px"}else{var y;(y=document.querySelector("#player_module")).style.height=u-0+"px",y.style.width="",y.style.paddingLeft="",y.style.left="",y.style.transform="",y.style.webkitTransform="";w=document.querySelector(".plp-l"),c=document.querySelector(".plp-r");w.removeAttribute("style"),c.removeAttribute("style")}}}if(window.isWide=md.forceWide||!!md.specialCover||!md.multiMode,window.hasBlackSide=Boolean(parseInt(getCookie("blackside_state"))),window.PlayerAgent={player_widewin:function(){window.isWide=true,setSize()},player_fullwin:function(){window.isWide=false,setSize()},toggleBlackSide:function(e){window.hasBlackSide=e,setSize()}},setSize(),window.document.body.style.opacity="",window.addEventListener("resize",setSize),!(ep&&ep.loaded&&-1<ep.id)||md.rights.appOnly||md.premiereInfo&&md.premiereInfo.epid===ep.id){insertScript()}else{var r=function(s){window.pgcPlayerLoaded=true;var e=window.__PGC_USERSTATE__.vip_info||{},a=window.__PGC_USERSTATE__.debugin&&(1===window.__PGC_USERSTATE__.pay||1===window.__PGC_USERSTATE__.sponsor||1===window.__PGC_USERSTATE__.pay_pack_paid||0!==e.type&&1===e.status);window.playerCallback=function(){window.jwTimer=setInterval(function(){var e=window.document.querySelector("#player_placeholder");"function"==typeof e.jwAddEventListener&&(e.jwAddEventListener("jwplayerMediaComplete","function(){ window.showPreviewMask();}"),clearInterval(window.jwTimer))},1000);var e=function(){window.player&&"function"==typeof window.player.addEventListener&&(window.player.addEventListener("video_media_play",function(){window.hadVideoPlay=true}),window.player.addEventListener("video_media_seek",function(){window.hadVideoPlay=true}),clearInterval(window.vMediaPTimer))};window.vMediaPTimer=setInterval(e,1000),e()},window.getPlayerExtraParams=function(){var e=window.__PGC_USERSTATE__.paster||{},i=ep.skip||{},t=window.__PGC_USERSTATE__.progress||{last_ep_id:-1},o=false;o=!window.hadVideoPlay&&(t.last_ep_id<0&&!t.last_ep_index&&!t.last_time);var n=window.__PGC_USERSTATE__&&window.__PGC_USERSTATE__.epsToastType,d=window.__PGC_USERSTATE__&&window.__PGC_USERSTATE__.toastTypeMap;return{title:ep.longTitle?ep.titleFormat+" "+ep.longTitle:ep.titleFormat,mediaTitle:md.title,epTitle:ep.longTitle,epIndex:ep.titleFormat,epCover:ep.cover,epStat:ep.epStatus||md.status,squarePic:md.squareCover||"//static.hdslb.com/images/square-cover-default.png",record:0!==ep.sectionType?"":md.playerRecord?encodeURIComponent(md.playerRecord):"",shareText:window.__INITIAL_STATE__.h1Title+" #哔哩哔哩#",sharePic:md.cover,shareUrl:"//www.bilibili.com/bangumi/play/ss"+md.ssId+"/",isStart:md.pub.isStart||!md.rights.canWatch&&0!==ep.sectionType,isPreview:md.rights.isPreview&&s,allowTicket:md.payMent.sixType.allowTicket,deadLineToast:md.payMent.sixType.allowTimeLimit&&!s&&window.__PGC_USERSTATE__.dead_line?window.__PGC_USERSTATE__.dead_line:undefined,canPlay1080:a,allowSponsor:md.rights.allowBp,multiMode:md.multiMode,epNeedPay:s,isFollow:1===window.__PGC_USERSTATE__.follow,canWatch:md.rights.canWatch,sponsorWeekList:[],sponsorTotalList:[],sponsorCount:0,danmakuListOffset:md.specialCover?0:64,paster:{aid:ep.aid||0,cid:e.aid||0,type:e.type||0,duration:e.duration||0,allow_jump:e.allow_jump||0,url:e.url?e.url:""},pubTime:md.pub.timeShow,recommend:[],epList:{},nextEp:null,headTail:{first:!!window.__PGC_USERSTATE__.debugin&&o,op:[i.op&&i.op.start||0,i.op&&i.op.end||0],ed:[i.ed&&i.ed.start||0,i.ed&&i.ed.end||0],hasSkip:ep.hasSkip||false},whitelistToast:n&&d&&"white_can_watch"===n[ep.id]&&d[n[ep.id]]&&d[n[ep.id]].text_info,preSaleToast:n&&d&&"presell"===n[ep.id]&&d[n[ep.id]]&&d[n[ep.id]].text_info}};var i,t,o;if("bangumi"===ep.from){var n=(i=new RegExp("(^|&)"+"t"+"=([^&|^#]*)(&|#|$)"),t=window.location.href.split("?"),null!==(o=(1<t.length?t[1]:"").match(i))?unescape(o[2]):""),d=window.__PGC_USERSTATE__.progress||{},r=d.last_time||0,l=-1<d.last_ep_id?d.last_ep_id:undefined,p=encodeURIComponent("module="+(2!==md.ssType?"bangumi":"movie")+"&season_type="+md.ssType),_=(1===(e=window.__PGC_USERSTATE__.vipInfo||{}).type||2===e.type)&&1===e.status,w=window.__PGC_USERSTATE__.paster||{},c=!_&&1!==window.__PGC_USERSTATE__.pay&&1!==window.__PGC_USERSTATE__.sponsor&&w.cid&&0<w.cid?1:undefined,m=window.__BILI_CONFIG__&&window.__BILI_CONFIG__.show_bv&&ep.bvid?"&bvid="+ep.bvid+"&show_bv=1":"",u="cid="+ep.cid+"&aid="+ep.aid+m+"&season_type="+md.ssType+(r?"&lastplaytime="+1000*r:"")+(l?"&last_ep_id="+l:"")+(c?"&pre_ad=1":"")+"&has_next="+(ep.hasNext?1:"")+(window.isWide?"&as_wide=1":"")+"&player_type="+(2!==md.ssType?1:2)+"&urlparam="+p+"&seasonId="+md.ssId+"&episodeId="+ep.id+"&record="+(0!==ep.sectionType?"":md.playerRecord?encodeURIComponent(md.playerRecord):"")+"&t="+n+(ep.attribute?"&attribute="+ep.attribute:"");window.EmbedPlayer("player","//static.hdslb.com/play.swf",u,"","",window.playerCallback)}else{(window.document.querySelector("#bilibili-player")||window.document.querySelector("#bofqi")).innerHTML='<embed height="100%" width="100%" src="//static.hdslb.com/tc.swf" type="application/x-shockwave-flash" pluginspage="//www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" allowscriptaccess="always" rel="noreferrer" quality="high" flashvars="bili-cid='+ep.cid+"&amp;bili-aid="+ep.aid+"&amp;vid="+ep.vid+'" allowfullscreen="true">'}},promiseArr=[];if(window.__PGC_USERSTATE__){startPlayer()}else{var cnt=0;function t(){new Promise(function(e){window.$.ajax({url:"//api.bilibili.com/pgc/view/web/season/user/status",type:"get",dataType:"json",xhrFields:{withCredentials:true},data:{season_id:md.ssId,ts:(new Date).getTime()},success:function(e){0===e.code?window.__PGC_USERSTATE__=e.result||{}:window.__PGC_USERSTATE__={}}}).always(e)}).then(function(){startPlayer()})}window.jQuery||(cnt+=1,loadScript("//static.hdslb.com/js/jquery.min.js",function(){0==--cnt&&t()})),window.Promise||(cnt+=1,loadScript("//static.hdslb.com/js/promise.auto.min.js",function(){0==--cnt&&t()}))}function startPlayer(){var e=false,i=true,t=false;window.__INITIAL_STATE__.sections.forEach(function(e){0<e.epList.length&&(t=true)});var o=window.__PGC_USERSTATE__.vipInfo||{},n=o&&(1===o.type||2===o.type)&&1===o.status,d=!(6!==ep.epStatus&&7!==ep.epStatus&&13!==ep.epStatus||window.__PGC_USERSTATE__.debugin&&n),s=12===ep.epStatus&&(!window.__PGC_USERSTATE__.debugin||1!==window.__PGC_USERSTATE__.pay_pack_paid),a=ep.rights&&ep.rights.allow_demand&&window.__PGC_USERSTATE__.demand&&window.__PGC_USERSTATE__.demand.no_pay_epids&&-1!==window.__PGC_USERSTATE__.demand.no_pay_epids.indexOf(ep.id);if(1!==window.__PGC_USERSTATE__.pay&&(d||8===ep.epStatus||9===ep.epStatus||s)&&(e=true),a||14===ep.epStatus?e=true:md.pub.isStart||0!==window.__INITIAL_STATE__.epList.length||t?md.rights.isPreview&&!ep.attribute&&(0<window.__INITIAL_STATE__.epList.length||t)?i=true:e&&(i=false):i=false,i){if("bangumi"===ep.from){var l=setTimeout(function(){clearTimeout(l),window.PlayerMediaLoaded=undefined,insertScript()},4000);window.PlayerMediaLoaded=function(){clearTimeout(l),window.performance&&window.performance.timing&&(window.performance.timing.firstscreenfinish=window.performance.timing.playerStage3||(new Date).getTime()),insertScript(),window.PlayerMediaLoaded=undefined}}else{insertScript()}r(e)}else{insertScript()}}}};</script></body></html>`;document.open(),document.write(doc.replaceAll(/___(\w+)___/g,(matched,major)=>obj.hasOwnProperty(major)?obj[major]:major)),document.close(),pod.docbuild=true}else setTimeout(()=>{docbuild(url)},2e3)})}("https://bangumi.bilibili.com/view/web_api/season?"+(vid=vid.startsWith("ep")?vid.replace("ep","ep_id="):vid.replace("ss","season_id=")))}history.pushState=u.history("pushState"),window.addEventListener("pushState",init),history.replaceState=u.history("replaceState"),window.addEventListener("replaceState",init),zproxy(),init()}}}}location.hostname.includes("nyaa")&&(GM_addStyle('body{font-family:"Microsoft YaHei UI", monospace}#navFilter-category .btn{background-color:#fff; color:#333; font-size: 14px}i.fa-download{display:none}'),pod.defaults={jsonrpc:"http://localhost:16800/jsonrpc",token:""},pod.aria2=u.load("aria2",pod.defaults),"object"!=typeof pod.aria2&&(pod.aria2=pod.defaults),pod.now=u.now(),pod.latest=u.load("latest",0),document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll("div.input-group > div").forEach((t,idx)=>{2===idx?(t.removeAttribute("placeholder"),t.addEventListener("focus",()=>{u.zdom().value=""})):t.style.cssText="display: none"}),document.querySelectorAll("a[title],a[rel~=nofollow]").forEach(t=>{t.setAttribute("target","_blank")}),document.querySelectorAll("i.fa-magnet").forEach(t=>{t.dataset.url=t.parentElement.getAttribute("href"),t.parentElement.removeAttribute("href"),t.parentElement.style.cssText="cursor: default",t.addEventListener("click",()=>{let dom=u.zdom();window.event.ctrlKey?GM_setClipboard(u.magnet(dom.dataset.url),"text"):u.download(dom.dataset.url)})});let dom=document.querySelector("#navbar").firstElementChild;null!=dom&&(dom.innerHTML="sukebei.nyaa.si"==location.host?'<li><a href="/?c=1_1">\u52a8\u6f2b</a></li><li><a href="/?c=1_3">\u6e38\u620f</a></li><li><a href="/?c=1_4">\u6f2b\u753b</a></li><li><a href="/?c=1_5">\u56fe\u7247</a></li><li><a href="/?c=1_2">\u540c\u4eba</a></li><li><a href="/?c=2_1">\u5199\u771f</a></li><li><a href="/?c=2_2">\u89c6\u9891</a></li><li><a href="https://nyaa.si">nyaa</a></li>':'<li><a href="/?c=1_3&s=seeders&o=desc">Anime</a></li><li><a href="/?c=1_1&s=seeders&o=desc">AMV</a></li><li><a href="/?c=2_0&s=seeders&o=desc">Audio</a></li><li><a href="/?c=5_1&s=seeders&o=desc">Graphic</a></li><li><a href="/?c=5_2&s=seeders&o=desc">Photo</a></li><li><a href="/?c=6_1&s=seeders&o=desc">App</a></li><li><a href="/?c=6_2&s=seeders&o=desc">Game</a></li><li><a href="https://sukebei.nyaa.si">18X</a></li>',document.querySelector("a.navbar-brand").addEventListener("contextmenu",zset,false))}));{function zproxy(){let xhr=unsafeWindow.XMLHttpRequest;unsafeWindow.XMLHttpRequest=new Proxy(XMLHttpRequest,{construct(target){let iurl,body,fake;return new Proxy(new target,{set(target,prop,value){return Reflect.set(target,prop,value)},get(target,prop){let value=target[prop];if("function"==typeof value)value=function(){switch(prop){case"open":iurl=arguments[1];break;case"send":body=arguments[0],iurl.includes("/proxyhttp")&&body.includes("vinfoad")&&(fake=(url=>{let req=new xhr;return req.open("GET",url,false),req.send(),req.responseText})(pod.home+"/api/vitx?zbody="+encodeURIComponent(body)))}return target[prop].apply(target,arguments)};else if("response"==prop&&iurl.includes("/proxyhttp")){let d=JSON.parse(fake.includes("vinfo")?fake:value);d.vinfo=JSON.parse(d.vinfo),d.vinfo.report="",d.vinfo.preview=Number.parseInt(d.vinfo.vl.vi[0].td),d.vinfo.vl.vi[0].wl.wi=[],d.vinfo.fl.fi=d.vinfo.fl.fi.filter(t=>["uhd","fhd","shd"].includes(t.formatdefn)),d.vinfo.fl.cnt=d.vinfo.fl.fi.length,value=JSON.stringify({errCode:0,vinfo:JSON.stringify(d.vinfo)}),68==(d=JSON.parse(fake)).code?u.dialog(pod.vli):u.dialog(d.message)}return value}})}})}"v.qq.com"==location.hostname&&(GM_addStyle("#ad_qll_width1,#ad_qll_width2,#ad_qll_width3,#new_vs3_banner1,#new_vs3_games,#pc_client,.quick_games,.quick_vip,.vip-button,.txp-little-tip,.player-side-ads,.site_footer,.txp-watermark{display: none !important}"),localStorage.setItem("__thumbplayer_setting__definition_vod","fhd"),location.pathname.startsWith("/x/cover/"))&&zproxy()}if("wallhaven.cc"==location.hostname&&(GM_addStyle("header.listing-header,header.thumb-listing-page-header{display:none}"),document.querySelector("#thumbs").addEventListener("click",e=>{if("preview"==e.target.className){let dom=u.zdom(1);fetch(dom.getAttribute("href")).then(r=>r.text()).then(d=>{GM_download(d.match(/<img id="wallpaper" src="(.+?)"/)[1],u.uid()+".jpg")})}})),"pan.baidu.com"==location.hostname){function uchange(url){GM_cookie.list({},(r,e)=>{e||r.forEach(t=>{GM_cookie.delete({name:t.name})})}),url&&setTimeout(()=>{location.href=url},2e3)}GM_addStyle('#layoutMain{font-size:14px}div.file-name{font-family:"Microsoft YaHei UI", monospace}.wp-side-options,span.newIcon,span[node-type=find-apps],[node-type=header-union],dd.desc-box>div,span.user-name{display:none !important}'),pod.msg={init:"HD2A\u521d\u59cb\u5316\u5931\u8d25 \u8bf7\u5b89\u88c5\u6700\u65b0\u7684\u7be1\u6539\u7334Beta\u7248\u4f7f\u7528",update:"\u811a\u672c\u6709\u65b0\u7684\u7248\u672c\u4e86 \u8bf7\u66f4\u65b0\u540e\u518d\u4f7f\u7528<br>\u64cd\u4f5c\u5b8c\u6210\u540e\u9700\u8981\u91cd\u65b0\u6253\u5f00\u767e\u5ea6\u7f51\u76d8\u9875\u9762\u624d\u80fd\u751f\u6548<br>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u6253\u5f00\u811a\u672c\u5347\u7ea7\u9875\u9762\u8bf7",https:`请<a href="${pod.home}">点击这里</a>检查可否正常连接解析服务器，如果提示安全限制请添加信任，操作完成后再刷新一次页面。`},pod.defaults={jsonrpc:"http://localhost:16800/jsonrpc",token:""},pod.aria2=u.load("aria2",pod.defaults),"object"!=typeof pod.aria2&&(pod.aria2=pod.defaults),"/disk/clear"==location.pathname?null!=unsafeWindow.locals&&(locals.set("is_vip",1),locals.set("is_svip",1),locals.set("vip_level",3)):"/disk/home"==location.pathname?(new MutationObserver((list,obs)=>{list.forEach(t=>{"header-apps"===t.target.getAttribute("node-type")&&(obs.disconnect(),t.addedNodes.forEach((dom,idx)=>{if(0==idx){let i=dom.cloneNode(true);i.children.forEach((t,idx)=>{idx<2||t.remove()}),i.childElementCount<3||i.children[2].remove(),i.style.cssText="cursor: default",i.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();{let dom=document.createElement("ul"),hs=(dom.className="ulist",dom.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();let s=e.target.closest("li").dataset.name;if("new"==s)uchange("//pan.baidu.com/login");else{let arr=u.load("ulist",[]),i=arr.findIndex(t=>t.uid==s);-1==i?uchange("//pan.baidu.com/login"):(arr[i].scookie.forEach(t=>{GM_cookie.set(t)}),setTimeout(()=>{pod.wait=0,location.href.includes("path=%2F&")||(location.hash="/all?path=%2F"),location.reload()},2e3))}}),'<li data-name="new"><svg xmlns="http://www.w3.org/2000/svg" width="72" height="72" fill="#999" class="bi bi-plus-square-dotted" viewBox="0 0 16 16"><path d="M2.5 0c-.166 0-.33.016-.487.048l.194.98A1.51 1.51 0 0 1 2.5 1h.458V0H2.5zm2.292 0h-.917v1h.917V0zm1.833 0h-.917v1h.917V0zm1.833 0h-.916v1h.916V0zm1.834 0h-.917v1h.917V0zm1.833 0h-.917v1h.917V0zM13.5 0h-.458v1h.458c.1 0 .199.01.293.029l.194-.981A2.51 2.51 0 0 0 13.5 0zm2.079 1.11a2.511 2.511 0 0 0-.69-.689l-.556.831c.164.11.305.251.415.415l.83-.556zM1.11.421a2.511 2.511 0 0 0-.689.69l.831.556c.11-.164.251-.305.415-.415L1.11.422zM16 2.5c0-.166-.016-.33-.048-.487l-.98.194c.018.094.028.192.028.293v.458h1V2.5zM.048 2.013A2.51 2.51 0 0 0 0 2.5v.458h1V2.5c0-.1.01-.199.029-.293l-.981-.194zM0 3.875v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zM0 5.708v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zM0 7.542v.916h1v-.916H0zm15 .916h1v-.916h-1v.916zM0 9.375v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zm-16 .916v.917h1v-.917H0zm16 .917v-.917h-1v.917h1zm-16 .917v.458c0 .166.016.33.048.487l.98-.194A1.51 1.51 0 0 1 1 13.5v-.458H0zm16 .458v-.458h-1v.458c0 .1-.01.199-.029.293l.981.194c.032-.158.048-.32.048-.487zM.421 14.89c.183.272.417.506.69.689l.556-.831a1.51 1.51 0 0 1-.415-.415l-.83.556zm14.469.689c.272-.183.506-.417.689-.69l-.831-.556c-.11.164-.251.305-.415.415l.556.83zm-12.877.373c.158.032.32.048.487.048h.458v-1H2.5c-.1 0-.199-.01-.293-.029l-.194.981zM13.5 16c.166 0 .33-.016.487-.048l-.194-.98A1.51 1.51 0 0 1 13.5 15h-.458v1h.458zm-9.625 0h.917v-1h-.917v1zm1.833 0h.917v-1h-.917v1zm1.834-1v1h.916v-1h-.916zm1.833 1h.917v-1h-.917v1zm1.833 0h.917v-1h-.917v1zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"></svg></li>');u.load("ulist",[]).filter(t=>t.uid!=pod.ui.uid).forEach(t=>{hs+=`<li data-name="${t.uid}"><img width="72" title="${t.monicker}" src="${t.avatar}"></li>`}),dom.insertAdjacentHTML("beforeend",hs),u.dialog(dom)}}),t.target.prepend(i)}[3,5].includes(idx)||dom.remove()}))})}).observe(document.querySelector("#layoutHeader"),{childList:true,subtree:true}),unsafeWindow.XMLHttpRequest=new Proxy(XMLHttpRequest,{construct(target){let iurl,body;return new Proxy(new target,{set(target,prop,value){return Reflect.set(target,prop,value)},get(target,prop){let value=target[prop];if("function"==typeof value)value=function(){switch(prop){case"open":iurl=arguments[1];break;case"send":body=arguments[0]}return target[prop].apply(target,arguments)};else if("responseText"==prop&&iurl.includes("/api/quota")){let usp=new URLSearchParams(u.strcut(iurl,"?"));if(pod.logid=usp.get("logid"),pod.dplogid=usp.get("dp-logid"),pod.bdstoken=usp.get("bdstoken"),null==pod.sign&&(pod.sign="invalid",fetch(`/api/gettemplatevariable?fields=${encodeURIComponent(JSON.stringify(["sign2","sign1","sign3","timestamp"]))}&channel=chunlei&web=1&app_id=250528&bdstoken=${pod.bdstoken}&logid=${pod.logid}&clienttype=0&dp-logid=${pod.dplogid}`).then(r=>r.json()).then(d=>{if(0==d.errno){pod.timestamp=d.result.timestamp;let foo=Function("return "+d.result.sign2)();pod.sign=btoa(foo(d.result.sign3,d.result.sign1))}else u.dialog("\u521d\u59cb\u5316\u8bfb\u53d6\u6570\u636e\u5931\u8d25 \u8bf7\u5237\u65b0\u9875\u9762")}),pod.usign)){let dom=document.querySelector("div[node-type=listTopTools]");dom&&(dom.innerHTML='<div class="btn-group outline" style="font-size: 12.5px"> <button name="zset"> <i class="bi-gear"></i> \u8bbe\u7f6e </button> <button name="video"> <i class="bi-heart"></i> \u70b9\u8d5e </button> <button name="dlink"> <i class="bi-cloud-download"></i> \u4e0b\u8f7d </button> </div>',document.querySelector("div.btn-group.outline").addEventListener("click",()=>{let dom=u.zdom(1).closest("button");switch(dom.getAttribute("name")){case"video":0==pod.wait&&(pod.wait=1,fetch(`${pod.home}/api/pibaidu?version=${pod.version}&usign=${pod.usign}`).then(r=>r.json()).then(d=>{if(0==d.code)if(null==pod.vli)u.dialog(pod.msg.https);else{let dom=pod.vli.querySelector("span[name=uut]");dom&&(dom.textContent=d.data-80,u.dialog(pod.vli.cloneNode(true)))}else u.dialog(d.message);pod.wait=0}));break;case"zset":zset();break;default:pod.icon=dom.children[0],async function(){if(pod.wait)u.dialog("\u8bf7\u7a0d\u540e\u518d\u8bd5");else{let arr=pod.dcontext.instanceForSystem.list.getSelected().reduce((d,t)=>(t.isdir?d=d.concat(function(path){let xhr=new XMLHttpRequest,d=(xhr.open("GET",`/rest/2.0/xpan/multimedia?method=listall&recursion=1&path=${encodeURIComponent(path)}`,false),xhr.send(),JSON.parse(xhr.responseText));return 0==d.errno?d.list:[]}(t.path)):d.push(t),d),[]).filter(t=>!t.isdir);if(arr.length){if(pod.wait=1,pod.icon.className="bi-arrow-clockwise spinner",2==pod.ui.vip){let bduss=u.strcut(pod.ui.cookie,"BDUSS=",";"),d=await fetch(`${pod.home}/api/pibaidu?usign=${pod.usign}`);if(null==pod?.token&&((d=await u.ajax({url:"https://openapi.baidu.com/oauth/2.0/authorize?client_id=IlLqBbU3GjQ0t46TRwFateTprHWl39zF&response_type=token&redirect_uri=oob&scope=basic%2Cnetdisk",responseType:"text"})).finalUrl.includes("access_token")?pod.token=u.strcut(d.finalUrl,"access_token=","&"):u.dialog("\u8bf7\u5c1d\u8bd5\u91cd\u65b0\u767b\u5f55\u767e\u5ea6\u7f51\u76d8\u8d26\u53f7")),pod?.token){let li=arr.map(t=>t.fs_id);0==(d=await u.ajax({url:`/rest/2.0/xpan/multimedia?method=filemetas&access_token=${pod.token}&dlink=1&fsids=${encodeURIComponent(JSON.stringify(li))}`,headers:{"User-Agent":"pan.baidu.com"}})).errno?(li=d.list.map(t=>({url:[t.dlink],header:["User-Agent: pan.baidu.com",`Cookie: BDUSS=${bduss}`],out:`baiduyun${t.path}`,split:"8"})),u.aria2(li)):u.dialog(d.errmsg)}}else{let body={sign:pod.sign,timestamp:pod.timestamp,fidlist:JSON.stringify(arr.map(t=>t.fs_id)),type:"dlink",vip:0,channel:"chunlei",web:1,app_id:"250528",bdstoken:pod.bdstoken,logid:pod.logid,jsToken:pod.jstoken,clienttype:0,"dp-logid":pod.dplogid},d=await fetch(`/api/download?${u.serialize(body)}`).then(r=>r.json());if(0===d.errno){let total=0;if(d.dlink.forEach(t1=>{let i=arr.find(t2=>t2.fs_id==t1.fs_id);t1.out=i.path,t1.size=1e6<i.size?Number.parseInt(i.size.toString().slice(0,-6)):1,total+=Math.ceil(t1.size/1024)}),arr=d.dlink,0==(d=await fetch(`${pod.home}/api/pibaidu?usign=${pod.usign}`).then(r=>r.json())).code)if(d.data>total+80)for(const i of arr)0==(d=await fetch(`${pod.home}/api/dlinkbaidu?usign=${pod.usign}&fe=${encodeURIComponent(JSON.stringify(i))}`).then(r=>r.json())).code&&u.aria2([d.data]);else u.dialog(`请点击「点赞」按钮打开列表给其中的视频点赞获取更多解析点数<br><br>每个视频点赞加两个解析点，需要等待视频播放区下方的「百度云分享」显示出来再进行点赞操作，否则不能识别导致无效。新注册的零级号点赞无效，需要在哔哩哔哩完成答题转正才可以正确识别出来。同一视频反复点赞无效且每次取消点赞会少减已有解析点数。<br>分享视频添加进点赞列表也可增加解析点数，在哔哩哔哩打开一个自己喜欢的视频点击播放区域下方的「百度云分享」即可，每天只能分享一个。<br>解析点数使用规则1个文件减1点，同时按文件大小每1GB再减1点，相当于解析下载小于1GB的文件减1点，2GB以内的减2点，以此类推。<br><br>更多详细内容请查阅「<a href="${pod.home}/bangumi/hd2a.htm" target="blank" referrerpolicy="no-referrer">脚本使用说明</a>」<br>`);else u.dialog(d.message)}else u.dialog(d1.errmsg)}pod.wait=0,pod.icon.className="bi-cloud-download"}else u.dialog("\u672a\u52fe\u9009\u6587\u4ef6")}}()}}))}}return value}})}}),fetch("/rest/2.0/xpan/nas?method=uinfo").then(r=>r.json()).then(d=>{0==d.errno?(pod.ui={uid:d.uk,vip:d.vip_type,avatar:d.avatar_url,monicker:d.baidu_name},GM_cookie.list({},(r,e)=>{if(null==e)if(pod.ui.cookie=(Array.isArray(r)&&r.length?u.cclean(r):[]).join(";"),pod.ui.cookie.includes("BDUSS")){fetch(`${pod.home}/api/vlike?version=${pod.version}`).then(r=>r.json()).then(d=>{switch(d.code){case 69:GM_openInTab(d.message),u.dialog(`${pod.msg.update}<a href="${d.message}">点击这里</a>`);break;case 0:pod.vli=document.createElement("div"),pod.vli.insertAdjacentHTML("beforeend",'<div style="padding-bottom: 10px">\u7ed9\u4e0b\u9762\u7684\u89c6\u9891\u70b9\u8d5e\u83b7\u5f97\u89e3\u6790\u70b9\u6570 &nbsp; \u5f53\u524d\u89e3\u6790\u70b9\u6570\uff1a<span name="uut"></span> <span style="float:right;color:#666">\u9f20\u6807\u6eda\u8f6e\u7ffb\u9875</span></div><ul class="vlist"></ul>'),pod.vli.querySelector("ul.vlist").insertAdjacentHTML("afterbegin",u.tpl('<li><a href="https://www.bilibili.com/video/[bvid]" target="_blank" referrerpolicy="no-referrer"><img width="160" src="[pic]@160w_100h_1c.webp" crossorigin="anonymous" referrerpolicy="no-referrer"><div class="title">[title]</div></a></li>',d.data));let now=u.now(),latest=GM_getValue("latest",0);latest<now&&(GM_setValue("latest",now+2e4),GM_setValue("vlist",d.data));break;default:u.dialog(`${d.message} 请尝试刷新页面`)}}),unsafeWindow.locals&&(locals.set("is_vip",1),locals.set("is_svip",1),locals.set("vip_level",8),pod.ui.avatar=locals.get("photo")),pod.ui.uid!=GM_getValue("bduid",0)&&GM_setValue("bduid",pod.ui.uid),pod.usign=encodeURIComponent(JSON.stringify({uid:pod.ui.uid,cookie:pod.ui.cookie})),pod.dcontext=unsafeWindow.require("system-core:context/context.js"),pod.dmessage=unsafeWindow.require("system-core:system/baseService/message/message.js"),pod.jstoken=unsafeWindow.jsToken,pod.ui.scookie=r;{let arr=u.load("ulist",[]);if(arr.length){let i=arr.findIndex(t=>t.uid==pod.ui.uid);-1==i?arr.push(pod.ui):arr.splice(i,1,pod.ui)}else arr.push(pod.ui);u.save("ulist",arr)}}else u.dialog(pod.msg.init);else u.dialog(pod.msg.init)})):u.dialog(d.errmsg)})):"/disk/main"==location.pathname&&document.addEventListener("DOMContentLoaded",e=>{if(location.hash.startsWith("#/index")){let s=u.strcut(location.hash,"path=","&");location.href=`//pan.baidu.com/disk/home?stayAtHome=true#/all?path=${s}`}})}else{let latest=GM_getValue("latest",0),vlist=GM_getValue("vlist",[]);pod.now>latest?(GM_setValue("latest",pod.now+3e3),fetch(`${pod.home}/api/vlike?version=${pod.version}`).then(r=>r.json()).then(d=>{0===d.code&&(vlist=d.data,GM_setValue("vlist",vlist),pod.vli=document.createElement("div"),pod.vli.insertAdjacentHTML("beforeend",'<div style="padding-bottom: 10px">\u4eba\u673a\u9a8c\u8bc1 \u8bf7\u7ed9\u4e0b\u9762\u7684\u4efb\u4e00\u89c6\u9891\u70b9\u8d5e \u5b8c\u6210\u540e\u8fd4\u56de\u6b64\u9875\u9762\u5237\u65b0\u5373\u53ef</div><ul class="vlist"></ul>'),pod.vli.querySelector("ul.vlist").insertAdjacentHTML("afterbegin",u.tpl('<li><a href="https://www.bilibili.com/video/[bvid]" target="_blank" referrerpolicy="no-referrer"><img width="160" src="[pic]@160w_100h_1c.webp" crossorigin="anonymous" referrerpolicy="no-referrer"><div class="title">[title]</div></a></li>',vlist)))})):(pod.vli=document.createElement("div"),pod.vli.insertAdjacentHTML("beforeend",'<div style="padding-bottom: 10px">\u4eba\u673a\u9a8c\u8bc1 \u8bf7\u7ed9\u4e0b\u9762\u7684\u4efb\u4e00\u89c6\u9891\u70b9\u8d5e \u5b8c\u6210\u540e\u8fd4\u56de\u6b64\u9875\u9762\u5237\u65b0\u5373\u53ef</div><ul class="vlist"></ul>'),pod.vli.querySelector("ul.vlist").insertAdjacentHTML("afterbegin",u.tpl('<li><a href="https://www.bilibili.com/video/[bvid]" target="_blank" referrerpolicy="no-referrer"><img width="160" src="[pic]@160w_100h_1c.webp" crossorigin="anonymous" referrerpolicy="no-referrer"><div class="title">[title]</div></a></li>',vlist)))}